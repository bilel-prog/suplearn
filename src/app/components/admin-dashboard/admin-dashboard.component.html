<div class="container">
  <h2>Admin Dashboard</h2>
  <p class="lead">Welcome, Admin!</p>

  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <h6 class="card-title">Total Resources</h6>
          <h2>{{ stats.totalResources }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-warning text-white">
        <div class="card-body">
          <h6 class="card-title">Pending Approval</h6>
          <h2>{{ stats.pendingApproval }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-body">
          <h6 class="card-title">Approved</h6>
          <h2>{{ stats.approvedCount }}</h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-danger text-white">
        <div class="card-body">
          <h6 class="card-title">Rejected</h6>
          <h2>{{ stats.rejectedCount }}</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Pending Approvals Section -->
  <div class="card mb-4">
    <div class="card-header bg-warning text-white">
      <h5 class="mb-0">
        <i class="fas fa-clock"></i> Pending Approvals ({{ pendingResources.length }})
      </h5>
    </div>
    <div class="card-body">
      <div *ngIf="pendingResources.length === 0" class="text-center text-muted py-4">
        <i class="fas fa-check-circle fa-3x mb-3"></i>
        <p>No pending approvals at this time.</p>
      </div>

      <div *ngFor="let resource of pendingResources" class="card mb-3 border-warning">
        <div class="card-body">
          <div class="row">
            <div class="col-md-8">
              <h5 class="card-title">
                <span class="badge bg-secondary me-2">{{ resource.type }}</span>
                {{ resource.title }}
              </h5>
              <p class="card-text text-muted">{{ resource.description }}</p>
              <div class="resource-meta">
                <small class="text-muted">
                  <i class="fas fa-user"></i> Uploaded by: 
                  <strong>{{ resource.uploadedBy?.firstName }} {{ resource.uploadedBy?.lastName }}</strong> 
                  ({{ resource.uploadedBy?.role }})
                  <br>
                  <i class="fas fa-envelope"></i> {{ resource.uploadedBy?.email }}
                  <br>
                  <i class="fas fa-file"></i> {{ resource.fileName }} 
                  ({{ ((resource.fileSize || 0) / 1024 / 1024).toFixed(2) }} MB)
                  <br>
                  <i class="fas fa-calendar"></i> Uploaded: {{ resource.uploadDate | date:'medium' }}
                </small>
              </div>
            </div>
            <div class="col-md-4 text-end">
              <button class="btn btn-success mb-2 w-100" (click)="approveResource(resource.id!)">
                <i class="fas fa-check"></i> Approve
              </button>
              <button class="btn btn-danger mb-2 w-100" (click)="rejectResource(resource.id!)">
                <i class="fas fa-times"></i> Reject
              </button>
              <button class="btn btn-info w-100" (click)="viewResource(resource.id!)">
                <i class="fas fa-eye"></i> View Details
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recently Approved Resources -->
  <div class="card">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">
        <i class="fas fa-check"></i> Recently Approved Resources
      </h5>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Title</th>
              <th>Type</th>
              <th>Uploader</th>
              <th>Views</th>
              <th>Downloads</th>
              <th>Rating</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let resource of approvedResources">
              <td>{{ resource.title }}</td>
              <td><span class="badge bg-info">{{ resource.type }}</span></td>
              <td>{{ resource.uploadedBy?.firstName }} {{ resource.uploadedBy?.lastName }}</td>
              <td>{{ resource.viewCount }}</td>
              <td>{{ resource.downloadCount }}</td>
              <td>
                <span class="text-warning">
                  <i class="fas fa-star"></i> {{ resource.averageRating | number:'1.1-1' }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- User Statistics -->
  <div class="row mt-4">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0"><i class="fas fa-users"></i> User Statistics</h5>
        </div>
        <div class="card-body">
          <ul class="list-group list-group-flush">
            <li class="list-group-item d-flex justify-content-between">
              <span>Total Users</span>
              <strong>{{ stats.totalUsers }}</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span>Active Students</span>
              <strong>{{ stats.activeStudents }}</strong>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0"><i class="fas fa-chart-line"></i> System Statistics</h5>
        </div>
        <div class="card-body">
          <ul class="list-group list-group-flush">
            <li class="list-group-item d-flex justify-content-between">
              <span>Total Downloads</span>
              <strong>{{ stats.totalDownloads }}</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              <span>Average Rating</span>
              <strong>{{ stats.averageRating | number:'1.1-1' }} / 5</strong>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
